---
applyTo: "src/pages/admin/AdminAttendanceEditor.tsx,src/pages/attendance/edit/AttendanceEdit.tsx"
---

# 勤怠編集ページ

勤怠編集ページは、スタッフ向け(デスクトップ/モバイル)と管理者向けに提供されています。スタッフ側は自分の勤怠情報にアクセスでき、修正申請を行うことができます。一方、管理者側は全スタッフの勤怠情報を閲覧・編集でき、必要に応じて修正を加えることが可能です。

スタッフ側の勤怠編集ページは、`src/pages/attendance/edit/AttendanceEdit.tsx`に実装されており、管理者側の勤怠編集ページは`src/pages/admin/AdminAttendanceEditor.tsx`に実装されています。

## 主な項目

### 定型入力

勤怠編集ページでは、定型入力機能を提供しています。これにより、よく使う勤務パターンを簡単に選択して入力でき、入力の手間を大幅に削減できます。定型入力は、以下のようなパターンが含まれます。

- クリア: 入力内容をリセットします。
- 通常勤務: AppConfig で設定された標準的な勤務時間と休憩時間を自動で入力します。
- 定時出勤: 出勤時間のみを標準時間で入力します。
- 定時退勤: 退勤時間のみを標準時間で入力します。(必要に応じて昼休憩も設定されます)

### 勤務日

表示している対象日が表示されています。

### 勤務時間

#### 勤務開始時間

勤務開始時間は、スタッフの勤務が始まる時間を示します。クイック入力ボタンを使用して予め設定された時間を簡単に入力できます。

#### 勤務終了時間

勤務終了時間は、スタッフの勤務が終わる時間を示します。こちらもクイック入力ボタンを利用して、標準的な終了時間を素早く設定できます。

#### 直行

直行オプションは、スタッフが直接現場に向かう場合に使用します。このオプションを選択すると、勤務開始時間に AppConfig で設定された既定の勤務時間が自動的に入力されます。

#### 直帰

直帰オプションは、スタッフが直接自宅に帰る場合に使用します。このオプションを選択すると、勤務終了時間に AppConfig で設定された既定の退勤時間が自動的に入力されます。

### 休憩時間

休憩時間は、開始時間と終了時間をセットにして管理します。休憩時間を追加する場合は「休憩時間を追加」ボタンをクリックし、必要な休憩時間を設定します。複数の休憩時間を設定することも可能です。
ただし、昼休憩は自動的に設定されるため、手動で追加する必要はありません。
法律で定められているため、6 時間以上勤務する場合は最低 30 分、8 時間以上勤務する場合は最低 1 時間の休憩の設定を確認するように促します。

#### 実労働時間

実労働時間は、勤務時間から休憩時間を差し引いた純粋な労働時間を示します。この値は自動的に計算され、スタッフが正確な労働時間を把握できるようにします。

計算式: 実労働時間 = 勤務終了時間 - 勤務開始時間 - 休憩時間合計

#### 振替休日

振替休日オプションは、スタッフが特定の日に勤務した場合に、その代わりに別の日を休日として取得できる機能です。このオプションを選択すると、振替休日の設定が可能になります。

振替休日に日付を設定した際に、「クリアして設定」と「クリアせず設定」の 2 つの選択肢を提供します。

- クリアして設定: 既存の勤務時間や休憩時間をクリアし、振替休日として設定します。
- クリアせず設定: 既存の勤務時間や休憩時間を保持したまま、振替休日として設定します。

#### 有給

有給オプションは、スタッフが有給休暇を取得する場合に使用します。このオプションを選択すると、有給休暇として設定され、勤務時間や休憩時間は既定の労働時間と休憩時間に基づいて自動的に入力されます。

#### 特別休暇

特別休暇オプションは、スタッフが特別な理由で休暇を取得する場合に使用します。このオプションを選択すると、特別休暇として設定され、勤務時間や休憩時間は既定の労働時間と休憩時間に基づいて自動的に入力されます。

#### 時間単位休暇

時間単位休暇オプションは、スタッフが部分的に休暇を取得する場合に使用します。時間単位休暇は、開始時刻と終了時刻をセットにして管理します。このオプションを選択すると、指定した時間帯が休暇として設定され、勤務時間や休憩時間は自動的に調整されます。

#### 備考

備考欄は、スタッフが勤怠に関する特記事項やメモを入力できるフィールドです。例えば、遅刻や早退の理由、特別な勤務状況などを記録する際に使用します。

#### 修正理由(スタッフのみ)

修正理由欄は、スタッフが勤怠情報を修正する際に、その理由を明確に記述するためのフィールドです。これにより、管理者が修正内容を把握しやすくなり、適切な対応が可能となります。

## バリデーションルール

勤怠編集ページでは、以下のバリデーションルールを適用しています。これにより、入力ミスや不正なデータの登録を防ぎ、正確な勤怠情報の管理を実現します。

- 勤務開始時間と勤務終了時間の整合性: 勤務終了時間は勤務開始時間よりも後である必要があります。
- 休憩時間の重複チェック: 複数の休憩時間が重複しないようにします。
- 法定休憩時間の確認: 6 時間以上勤務する場合は最低 30 分、8 時間以上勤務する場合は最低 1 時間の休憩が設定されていることを確認します。
- 振替休日と有給・特別休暇の排他性: 振替休日は有給休暇や特別休暇と同時に設定できないようにします。
- 時間単位休暇の範囲チェック: 時間単位休暇の開始時刻と終了時刻が勤務時間内に収まっていることを確認します。
